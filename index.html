<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My BookTok Shelf</title>
<meta name="description" content="Build a dreamy BookTok bookshelf with draggable covers. Search classics, drag onto shelves, save, and export a TikTok-ready image." />
<link rel="preconnect" href="https://covers.openlibrary.org">
<style>
:root{
  --bg:#f6f1ee; --ink:#2c2624; --muted:#7b6d66; --pearl:#fffbf7;
  --wood1:#b07a52; --wood2:#6f4b34; --gold:#c7a76e; --shadow:0 16px 44px rgba(0,0,0,.10);
}
*{box-sizing:border-box}
body{margin:0;background:linear-gradient(180deg,var(--bg),#fefefe 60%);color:var(--ink);font:16px/1.35 ui-serif, Georgia, "Times New Roman", serif}
header{position:sticky;top:0;z-index:5;background:linear-gradient(90deg,#fffaf7, #fff);border-bottom:1px solid #eee}
.bar{max-width:1200px;margin:0 auto;padding:10px 16px;display:flex;gap:10px;align-items:center}
h1{font-size:clamp(20px,3.5vw,32px);margin:0;font-weight:600}
.pill{background:var(--pearl);border:1px solid #eadfd9;padding:8px 10px;border-radius:999px;display:flex;gap:8px;align-items:center;flex:1}
.pill input{all:unset;flex:1; font:16px/1.2 ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial; color:#333}
.btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;background:#222;color:#fff;font-weight:600;cursor:pointer;box-shadow:0 6px 14px rgba(0,0,0,.12)}
.btn.alt{background:#fff;color:#222;border:1px solid #ddd}
.btn.ghost{background:transparent;border:1px dashed #cbbfb7;color:#6a5a53}
main{max-width:1200px;margin:16px auto;padding:0 16px;display:grid;grid-template-columns:340px 1fr;gap:16px}
@media (max-width: 960px){ main{grid-template-columns:1fr} }
.panel{background:linear-gradient(180deg,#fff, #fffaf8);border:1px solid #eee;border-radius:20px;overflow:hidden;box-shadow:0 10px 24px rgba(0,0,0,.05)}
.panel h2{font-size:18px;margin:0;padding:14px 16px;border-bottom:1px solid #f0e8e3;background:linear-gradient(90deg, #fff, #fff7f2)}
.panel .content{padding:14px 12px}
.chips{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px}
.chip{padding:6px 10px;border-radius:999px;border:1px solid #e7ddd7;background:#fff;color:#4a3f39;cursor:pointer;font: 13px/1 ui-sans-serif, system-ui}
.chip:hover{background:#fff4fa}
.results{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
@media (max-width: 480px){ .results{grid-template-columns:repeat(2,1fr)} }
.book-card{position:relative;border-radius:12px;overflow:hidden;background:#f5f1ee;border:1px solid #e9dfd8;display:flex;align-items:center;justify-content:center;cursor:grab;min-height:170px}
.book-card img{width:100%;height:100%;object-fit:cover;display:block}
.book-card .ttl{position:absolute;inset:auto 6px 6px 6px;background:linear-gradient(180deg,rgba(0,0,0,.0), rgba(0,0,0,.55));color:#fff;padding:6px 8px;border-radius:8px;font:12px/1.2 ui-sans-serif, system-ui}
.workspace{display:flex;flex-direction:column;gap:12px}
.canvas-wrap{background:radial-gradient(1000px 500px at 70% 10%, #fff, #fff4f0 60%, #ffece2);border:1px solid #eee;border-radius:22px;overflow:hidden;box-shadow:0 16px 40px rgba(0,0,0,.09)}
.toolbar{display:flex;flex-wrap:wrap;gap:8px;padding:12px;border-bottom:1px solid #efe6e0;background:linear-gradient(90deg,#fff,#fff9f6)}
.board-outer{display:flex;justify-content:center;align-items:center;padding:16px}
.board{position:relative;width:360px;height:640px;border-radius:22px;background:radial-gradient(80% 50% at 50% 0%, #fff 0%, #fff6 50%, #f9efe7 100%), linear-gradient(180deg,#f6ebe3,#fffdfa);box-shadow: inset 0 0 0 1px #ead8cf, inset 0 30px 80px rgba(190,150,120,.25), var(--shadow); overflow:hidden}
@media (min-width:1024px){ .board{width:540px;height:960px} }
/* Bookcase frame */
.board::before, .board::after{content:"";position:absolute;top:0;bottom:0;width:12px;background:linear-gradient(180deg,#ccb19a,#b69074);box-shadow:inset 0 1px 0 #fff6}
.board::before{left:0;border-radius:22px 0 0 22px}
.board::after{right:0;border-radius:0 22px 22px 0}
.room-bg{position:absolute;inset:0;background:
  radial-gradient(120% 70% at 50% -10%, rgba(202,220,255,.35), transparent 60%),
  radial-gradient(80% 40% at 10% 20%, rgba(217,245,230,.35), transparent 60%),
  radial-gradient(80% 40% at 90% 20%, rgba(255,223,237,.35), transparent 60%)}
.titleplate{position:absolute;top:16px;left:50%;transform:translateX(-50%);font-weight:700;color:#3a2e2a;background:linear-gradient(180deg,#fff8,#fff0);backdrop-filter: blur(3px);padding:10px 18px;border-radius:999px;border:1px solid #ead8cf;box-shadow:0 10px 22px rgba(0,0,0,.08)}
.shelves{position:absolute;inset:72px 10px 76px 10px}
.shelf{position:absolute;left:8px;right:8px;height:140px;border-radius:12px;background:linear-gradient(180deg, var(--wood1), var(--wood2));box-shadow:0 12px 26px rgba(0,0,0,.32), inset 0 2px 0 rgba(255,255,255,.25);border:1px solid rgba(0,0,0,.28)}
.shelf .plaque{position:absolute;bottom:8px;left:50%;transform:translateX(-50%);padding:3px 12px;border-radius:12px;background:linear-gradient(180deg,#f6efe6,#ebdccf);border:1px solid #d6c2af;color:#6a5342;font:12px/1.1 ui-sans-serif,system-ui;box-shadow:inset 0 1px 0 #fff6}
.book{position:absolute;bottom:10px;width:62px;height:86px;border-radius:6px;box-shadow:0 10px 18px rgba(0,0,0,.30);transform:rotate(var(--rot, -0.5deg));transform-origin:bottom center;cursor:grab;user-select:none;transition:transform .15s ease, filter .2s ease}
.book:hover{transform:translateY(-2px) rotate(var(--rot, -0.5deg));filter:brightness(1.03)}
.book img{width:100%;height:100%;object-fit:cover;border-radius:6px}
.book::after{content:"";position:absolute;inset:0;border-radius:6px;background:linear-gradient(90deg, rgba(0,0,0,.18), transparent 18%, transparent 82%, rgba(255,255,255,.25));mix-blend-mode:soft-light;pointer-events:none}
.badge{position:absolute;bottom:10px;right:10px;background:rgba(255,255,255,.92);color:#3a2e2a;border:1px solid #eadfdb;font:11px/1.2 ui-sans-serif, system-ui;padding:6px 10px;border-radius:999px;box-shadow:0 6px 14px rgba(0,0,0,.10)}
.curtain{position:absolute;top:-40px;left:-20px;right:-20px;height:120px;background:radial-gradient(100% 80% at 50% 20%, rgba(255,255,255,.9), rgba(255,240,248,.7) 60%, transparent 70%)}
.fairy-lights{position:absolute;top:58px;left:14px;right:14px;height:22px;pointer-events:none;background:
  radial-gradient(6px 6px at 0% 60%, rgba(255,240,180,.95), transparent 60%),
  radial-gradient(6px 6px at 10% 40%, rgba(255,220,200,.95), transparent 60%),
  radial-gradient(6px 6px at 20% 60%, rgba(210,240,255,.95), transparent 60%),
  radial-gradient(6px 6px at 30% 40%, rgba(255,240,180,.95), transparent 60%),
  radial-gradient(6px 6px at 40% 60%, rgba(210,240,255,.95), transparent 60%),
  radial-gradient(6px 6px at 50% 40%, rgba(255,220,200,.95), transparent 60%),
  radial-gradient(6px 6px at 60% 60%, rgba(255,240,180,.95), transparent 60%),
  radial-gradient(6px 6px at 70% 40%, rgba(210,240,255,.95), transparent 60%),
  radial-gradient(6px 6px at 80% 60%, rgba(255,220,200,.95), transparent 60%),
  radial-gradient(6px 6px at 90% 40%, rgba(255,240,180,.95), transparent 60%)}
.plant{position:absolute;bottom:12px;width:96px;height:96px;border-radius:18px;overflow:hidden;box-shadow:0 8px 18px rgba(0,0,0,.25);background-size:cover;background-position:center}
.plant.left{left:12px;background-image:url('https://images.unsplash.com/photo-1523575708161-ad0fc2a9b951?auto=format&fit=crop&w=256&q=80')}
.plant.right{right:12px;background-image:url('https://images.unsplash.com/photo-1520880867055-1e30d1cb001c?auto=format&fit=crop&w=256&q=80')}
.frame-quote{position:absolute;top:112px;right:18px;width:42%;max-width:210px;padding:8px 10px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff7);border:1px solid #e6d4c5;box-shadow:0 6px 16px rgba(0,0,0,.08);font:12px/1.35 Georgia,serif;color:#5a4b43}
/* Themes */
#board[data-theme="coquette"]{background:linear-gradient(180deg,#fff,#fff7), radial-gradient(100% 70% at 50% -10%, #ffeaf2, transparent 60%), radial-gradient(80% 40% at 90% 20%, #e8f6ff, transparent 60%), radial-gradient(80% 40% at 10% 20%, #f7ffe9, transparent 60%)}
#board[data-theme="dark"]{background:linear-gradient(180deg,#2a2522,#3b3431); color:#f1ebe6}
#board[data-theme="dark"] .titleplate{color:#f1ebe6;border-color:#52443b}
#board[data-theme="dark"] .shelf{background:linear-gradient(180deg,#5f4939,#3a2a21);box-shadow:0 12px 24px rgba(0,0,0,.45), inset 0 2px 0 rgba(255,255,255,.08)}
#board[data-theme="dark"] .badge{background:rgba(30,27,25,.8);color:#f1ebe6;border-color:#4c413a}
#board[data-theme="cottage"]{background:linear-gradient(180deg,#f7fff5,#fffdfa), radial-gradient(100% 70% at 50% -10%, #e7ffe8, transparent 60%), radial-gradient(80% 40% at 90% 20%, #fff0f7, transparent 60%)}
</style>
</head>
<body>
<header>
  <div class="bar">
    <h1>✨ BookTok Aesthetic Bookshelf</h1>
    <div class="pill" style="max-width:560px">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21l-4.3-4.3" stroke="#7b6d66" stroke-width="1.6" stroke-linecap="round"/><circle cx="11" cy="11" r="7" stroke="#7b6d66" stroke-width="1.6" fill="none"/></svg>
      <input id="q" placeholder="Search public-domain classics (e.g., pride and prejudice)"/>
      <button class="btn alt" id="go">Search</button>
    </div>
    <button class="btn" id="export">Export PNG</button>
  </div>
</header>
<main>
  <section class="panel" aria-label="Search and picks">
    <h2>Discover Classics</h2>
    <div class="content">
      <div class="chips" id="chips"></div>
      <div class="results" id="results" aria-live="polite"></div>
    </div>
  </section>
  <section class="workspace">
    <div class="canvas-wrap">
      <div class="toolbar">
        <button class="btn ghost" id="clear">Clear shelf</button>
        <button class="btn ghost" id="save">Save</button>
        <button class="btn ghost" id="load">Load</button>
        <div class="spacer"></div>
        <label class="note" style="display:flex;align-items:center;gap:6px">Theme:
          <select id="theme" style="border:1px solid #e3d7cf;border-radius:10px;padding:6px 10px;background:#fff"> 
            <option value="coquette">Coquette</option>
            <option value="dark">Dark Academia</option>
            <option value="cottage">Cottagecore</option>
          </select>
        </label>
        <label class="note" style="display:flex;align-items:center;gap:6px;margin-left:8px">
          <input type="checkbox" id="lights" checked /> Fairy lights
        </label>
        <label class="note" style="display:flex;align-items:center;gap:6px;margin-left:8px">Shelves:
          <select id="shelfCount" style="border:1px solid #e3d7cf;border-radius:10px;padding:6px 10px;background:#fff">
            <option value="2">2</option>
            <option value="3" selected>3</option>
          </select>
        </label>
      </div>
    </div>
    <div class="board-outer">
      <div class="board" id="board" data-theme="coquette">
        <div class="room-bg"></div>
        <div class="curtain"></div>
        <div class="fairy-lights" id="fairy"></div>
        <div class="titleplate">My BookTok Shelf</div>
        <div id="shelves" class="shelves"></div>
        <div class="plant left"></div>
        <div class="plant right"></div>
        <div class="frame-quote">“I declare after all there is no enjoyment like reading.”</div>
        <div class="badge">#BookTok • Public Domain</div>
      </div>
    </div>
  </section>
</main>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const resultsEl = $('#results');
const chipsEl = $('#chips');
const board = $('#board');
const themeSel = $('#theme');
const fairy = $('#fairy');
const lightsToggle = $('#lights');
const shelvesEl = $('#shelves');
const shelfCountSel = $('#shelfCount');

const presetQueries = ['pride and prejudice','jane eyre','wuthering heights','dracula','frankenstein','the picture of dorian gray','the count of monte cristo','les miserables','little women','the secret garden','emma jane austen','a tale of two cities'];
function renderChips(){ chipsEl.innerHTML=''; presetQueries.forEach(q=>{ const b=document.createElement('button'); b.className='chip'; b.textContent=q; b.onclick=()=>doSearch(q); chipsEl.appendChild(b); }); }

async function doSearch(query){
  $('#q').value = query;
  resultsEl.innerHTML = '<div class="note" style="grid-column:1/-1">Searching…</div>';
  try{
    const res = await fetch(`https://openlibrary.org/search.json?q=${encodeURIComponent(query)}&limit=18`);
    const data = await res.json();
    const docs = data.docs || [];
    if(!docs.length){ resultsEl.innerHTML = '<div class="note" style="grid-column:1/-1">No results. Try another classic.</div>'; return; }
    resultsEl.innerHTML='';
    docs.forEach(d=>{
      const card=document.createElement('div'); card.className='book-card'; card.draggable=true;
      const title=d.title||'Untitled'; const author=(d.author_name&&d.author_name[0])||''; const coverId=d.cover_i; const src=coverId?`https://covers.openlibrary.org/b/id/${coverId}-L.jpg`:'';
      card.dataset.title=title; card.dataset.author=author; card.dataset.src=src;
      card.addEventListener('dragstart',e=>{ e.dataTransfer.setData('text/plain', JSON.stringify({title,author,src})); });
      if(src){ const im=new Image(); im.src=src; im.alt=`${title} — ${author}`; im.loading='lazy'; card.appendChild(im);} else { card.innerHTML=`<div class='ttl'>${title}</div>`; }
      const ttl=document.createElement('div'); ttl.className='ttl'; ttl.textContent=`${title}${author?' — '+author:''}`; card.appendChild(ttl);
      resultsEl.appendChild(card);
    });
  }catch{ resultsEl.innerHTML = '<div class="note" style="grid-column:1/-1">Search error. Try again.</div>'; }
}

function renderShelves(count=3){
  shelvesEl.innerHTML='';
  const labels = count===2? ['Favorites','Classics'] : ['Top Picks','TBR','Classics'];
  const rect = board.getBoundingClientRect();
  const topPad=84, bottomPad=88; // tighter padding
  const avail = (rect.height||640) - topPad - bottomPad;
  const minGap = 8; // minimal whitespace between shelves
  const shelfH = Math.floor((avail - minGap*(count-1)) / count);
  const gap = minGap;
  for(let i=0;i<count;i++){
    const shelf=document.createElement('div');
    shelf.className='shelf';
    shelf.style.top = (topPad + i*(shelfH+gap)) + 'px';
    shelf.style.height = shelfH + 'px';
    const plaque=document.createElement('div');
    plaque.className='plaque';
    plaque.textContent=labels[i]||`Shelf ${i+1}`;
    shelf.appendChild(plaque);
    shelvesEl.appendChild(shelf);
  }
  bindShelfDnD();
}`; shelf.appendChild(plaque);
    shelvesEl.appendChild(shelf);
  }
  bindShelfDnD();
}

function bindShelfDnD(){
  $$('.shelf').forEach(shelf=>{
    shelf.addEventListener('dragover',e=>e.preventDefault());
    shelf.addEventListener('drop',e=>{ e.preventDefault(); try{ const data=JSON.parse(e.dataTransfer.getData('text/plain')); const rect=shelf.getBoundingClientRect(); const x=e.clientX-rect.left; placeBookOnShelf(shelf,data,x); persist(); }catch(err){ console.warn(err); } });
  });
}

function rand(a,b){ return a+Math.random()*(b-a); }
function placeBookOnShelf(shelf,{title,author,src},x){
  const el=document.createElement('div'); el.className='book'; el.style.left=Math.max(6, Math.min((shelf.clientWidth-70), (x||40)-30))+'px'; el.style.setProperty('--rot',(Math.random()<.5?-1:1)*rand(0,1.2)+'deg'); el.dataset.title=title; el.dataset.author=author; el.dataset.src=src||'';
  const img=new Image(); img.src=src||placeholderCover(title,author); img.alt=`${title} — ${author}`; el.appendChild(img);
  el.addEventListener('click',()=>{ const cur=parseFloat((getComputedStyle(el).getPropertyValue('--rot')||'0deg').replace('deg','')); const next=Math.abs(cur)<0.2?rand(-1.5,1.5):-cur*0.9; el.style.setProperty('--rot', next+'deg'); });
  let t; el.addEventListener('pointerdown',()=>{ t=setTimeout(()=>{ el.remove(); persist(); },600)}); ['pointerup','pointerleave'].forEach(v=>el.addEventListener(v,()=>clearTimeout(t)));
  shelf.appendChild(el);
}
function placeholderCover(title,author){ const t=(title||'Untitled').slice(0,36).replace(/&/g,'&amp;'); const a=(author||'').slice(0,28).replace(/&/g,'&amp;'); const svg=`<svg xmlns='http://www.w3.org/2000/svg' width='400' height='550'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop offset='0%' stop-color='#d8ecff'/><stop offset='100%' stop-color='#ffe1ea'/></linearGradient></defs><rect width='100%' height='100%' fill='url(#g)'/><rect x='18' y='18' width='364' height='514' rx='14' fill='rgba(255,255,255,.4)' stroke='rgba(0,0,0,.06)'/><text x='36' y='280' font-family='Georgia,serif' font-size='28' fill='#2b2a2a'>${t}</text><text x='36' y='318' font-family='Georgia,serif' font-size='16' fill='#5a5552'>${a}</text></svg>`; return 'data:image/svg+xml;utf8,'+encodeURIComponent(svg); }

$('#export').addEventListener('click', async ()=>{ const canvas=await html2canvas(board,{scale:2,backgroundColor:null}); const a=document.createElement('a'); a.href=canvas.toDataURL('image/png'); a.download='my-booktok-shelf.png'; a.click(); });
$('#clear').addEventListener('click',()=>{ $$('.book').forEach(b=>b.remove()); persist(); });
$('#save').addEventListener('click',()=>{ persist(); alert('Shelf saved!'); });
$('#load').addEventListener('click',()=> restore());
function persist(){ const all=[]; $$('.shelf').forEach((s,idx)=>{ s.querySelectorAll('.book').forEach(b=>{ all.push({shelf:idx,left:parseFloat(b.style.left),rot:getComputedStyle(b).getPropertyValue('--rot'),title:b.dataset.title,author:b.dataset.author,src:b.dataset.src}) }); }); localStorage.setItem('booktok-shelf', JSON.stringify(all)); }
function restore(){ $$('.book').forEach(b=>b.remove()); const all=JSON.parse(localStorage.getItem('booktok-shelf')||'[]'); const shelves=$$('.shelf'); all.forEach(it=>{ const shelf=shelves[it.shelf]||shelves[0]; placeBookOnShelf(shelf,it,(it.left||20)+30); const last=shelf.lastElementChild; if(last) last.style.setProperty('--rot', it.rot||'-0.5deg'); }); }
$('#go').addEventListener('click',()=>doSearch($('#q').value||'pride and prejudice'));
$('#q').addEventListener('keydown',e=>{ if(e.key==='Enter') $('#go').click(); });

renderChips();
const storedCount=parseInt(localStorage.getItem('booktok-shelf-count')||'3',10); renderShelves([2,3].includes(storedCount)?storedCount:3);
if(shelfCountSel){ shelfCountSel.value=String([2,3].includes(storedCount)?storedCount:3); shelfCountSel.addEventListener('change',()=>{ const c=parseInt(shelfCountSel.value,10); localStorage.setItem('booktok-shelf-count', String(c)); renderShelves(c); restore(); }); }
restore();
if(localStorage.getItem('booktok-theme')){ board.dataset.theme=localStorage.getItem('booktok-theme'); themeSel.value=board.dataset.theme; }
themeSel.addEventListener('change',()=>{ const v=themeSel.value; board.dataset.theme=v; localStorage.setItem('booktok-theme', v); });
lightsToggle.addEventListener('change',()=>{ fairy.style.display = lightsToggle.checked? '':'none'; });
// Default search
doSearch('pride and prejudice');
</script>
</body>
</html>



